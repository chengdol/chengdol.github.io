<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="中文|English">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=6.7.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.7.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.7.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.7.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.7.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.7.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="OK, This article is a summary from IBM developer Linux series that contains something I haven’t realized and history information about YUM and RPM. Introducing package management In the past, many Lin">
<meta name="keywords" content="linux,yum,rpm">
<meta property="og:type" content="article">
<meta property="og:title" content="Yum and Rpm Management 101">
<meta property="og:url" content="http://yoursite.com/2019/03/26/linux-yum-rpm-management/index.html">
<meta property="og:site_name" content="海胆阶段&#39;s Blog">
<meta property="og:description" content="OK, This article is a summary from IBM developer Linux series that contains something I haven’t realized and history information about YUM and RPM. Introducing package management In the past, many Lin">
<meta property="og:locale" content="中文|English">
<meta property="og:updated_time" content="2021-05-06T07:42:52.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Yum and Rpm Management 101">
<meta name="twitter:description" content="OK, This article is a summary from IBM developer Linux series that contains something I haven’t realized and history information about YUM and RPM. Introducing package management In the past, many Lin">






  <link rel="canonical" href="http://yoursite.com/2019/03/26/linux-yum-rpm-management/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Yum and Rpm Management 101 | 海胆阶段's Blog</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="中文|English">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">海胆阶段's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags<span class="badge">158</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories<span class="badge">47</span></a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives<span class="badge">288</span></a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/26/linux-yum-rpm-management/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="海胆阶段">
      <meta itemprop="description" content="骐骥一跃，不能十步；驽马十驾，功在不舍">
      <meta itemprop="image" content="/images/cuishao.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="海胆阶段's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Yum and Rpm Management 101

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-03-26 22:50:55" itemprop="dateCreated datePublished" datetime="2019-03-26T22:50:55-07:00">2019-03-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2021-05-06 00:42:52" itemprop="dateModified" datetime="2021-05-06T00:42:52-07:00">2021-05-06</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>OK, This article is a summary from IBM developer <a href="https://developer.ibm.com/tutorials/l-lpic1-102-5/" target="_blank" rel="noopener">Linux series</a> that contains something I haven’t realized and history information about YUM and RPM.</p>
<h3 id="Introducing-package-management">Introducing package management</h3>
<p>In the past, many Linux programs were distributed as source code, which a user would build into the required program or set of programs, along with the required man pages, configuration files, and so on. Nowadays, most Linux distributors use prebuilt programs or sets of programs called <em>packages</em>, which ship ready for installation on that distribution. In this tutorial, you will learn about <em>package management tools</em> that help you install, update, and remove packages. This tutorial focuses on the <strong>Red Hat Package Manager (RPM)</strong>, which was developed by Red Hat, as well as the <strong>Yellowdog Updater Modified (YUM)</strong>, which was originally developed to manage Red Hat Linux systems at Duke University’s Physics department. Another tutorial in this series, “<a href="https://developer.ibm.com/tutorials/l-lpic1-102-4/" target="_blank" rel="noopener">Learn Linux 101: Debian package management</a>,” covers the package management tools used on Debian systems.</p>
<h3 id="Package-managers">Package managers</h3>
<p>RPM, YUM, and APT (for Debian systems) have many similarities. All can install and remove packages. Information about installed packages is kept in a database. All have basic command-line functionality, while additional tools can provide more user-friendly interfaces. All can retrieve packages from the Internet.</p>
<p>When you install a Linux system, you typically install a large selection of packages. The set may be customized to the intended use of the system, such as a server, desktop, or developer workstation. And at some time you will probably need to install new packages for added functionality, update the packages you have, or even remove packages that you no longer need or that have been made obsolete by newer packages. Let’s look at how you do these tasks, and at some of the related challenges such as finding which package might contain a particular command.</p>
<h4 id="RPM">RPM</h4>
<p>Red Hat introduced RPM in 1995. RPM is now the package management system used for packaging in the Linux Standard Base (LSB). The rpm command options are grouped into three subgroups for:</p>
<ul>
<li>Querying and verifying packages</li>
<li>Installing, upgrading, and removing packages</li>
<li>Performing miscellaneous functions</li>
</ul>
<h4 id="YUM">YUM</h4>
<p>YUM adds automatic updates and package management, including dependency management, to RPM systems. In addition to understanding the installed packages on a system, YUM is like the Debian Advanced Packaging Tool (APT) in that it works with repositories, which are collections of packages and are typically accessible over a network connection.</p>
<h3 id="Install-RPM-packages">Install RPM packages</h3>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@attic‑f21 ~rpm ‑i  gcc‑gfortran‑4.9.2‑6.fc21.x86_64.rpm </span><br><span class="line">error: Failed dependencies:</span><br><span class="line">    libquadmath‑devel = 4.9.2‑6.fc21 is needed by gcc‑gfortran‑4.9.2‑6.fc21.x86_64</span><br></pre></td></tr></table></figure>
<p>One good thing is that you can give the rpm command a list of packages to install and it will install them all in the right order if all dependencies are satisfied. So you at least don’t have to manually install each piece in the right order.</p>
<p><a href="https://unix.stackexchange.com/questions/158244/what-is-the-difference-between-i686-and-x86-64-packages" target="_blank" rel="noopener">What is the difference between i686 and x86_64 packages?</a>
Technically, i686 is actually a 32-bit instruction set (part of the x86 family line), while x86_64 is a 64-bit instruction set (also referred to as amd64).</p>
<p>let’s see the yum install output in my machine:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">Loaded plugins: product-id, search-disabled-repos</span><br><span class="line">Local-Base                                                                                | 2.0 kB  00:00:00     </span><br><span class="line">Local-Extras                                                                              | 2.9 kB  00:00:00     </span><br><span class="line">Local-Optional                                                                            | 2.0 kB  00:00:00     </span><br><span class="line">Local-Supplementary                                                                       | 2.0 kB  00:00:00     </span><br><span class="line">(1/6): Local-Base/updateinfo                                                              | 3.2 MB  00:00:00     </span><br><span class="line">(2/6): Local-Supplementary/primary                                                        |  99 kB  00:00:00     </span><br><span class="line">(3/6): Local-Optional/updateinfo                                                          | 2.3 MB  00:00:00     </span><br><span class="line">(4/6): Local-Optional/primary                                                             | 5.0 MB  00:00:00     </span><br><span class="line">(5/6): Local-Supplementary/updateinfo                                                     |  69 kB  00:00:00     </span><br><span class="line">(6/6): Local-Base/primary                                                                 |  34 MB  00:00:00     </span><br><span class="line">Local-Base                                                                                           23907/23907</span><br><span class="line">Local-Optional                                                                                       17526/17526</span><br><span class="line">Local-Supplementary                                                                                      310/310</span><br><span class="line">Resolving Dependencies</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package vim-enhanced.x86_64 2:7.4.160-5.el7 will be installed</span><br><span class="line">--&gt; Processing Dependency: vim-common = 2:7.4.160-5.el7 for package: 2:vim-enhanced-7.4.160-5.el7.x86_64</span><br><span class="line">--&gt; Processing Dependency: libgpm.so.2()(64bit) for package: 2:vim-enhanced-7.4.160-5.el7.x86_64</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package gpm-libs.x86_64 0:1.20.7-5.el7 will be installed</span><br><span class="line">---&gt; Package vim-common.x86_64 2:7.4.160-5.el7 will be installed</span><br><span class="line">--&gt; Processing Dependency: vim-filesystem for package: 2:vim-common-7.4.160-5.el7.x86_64</span><br><span class="line">--&gt; Running transaction check</span><br><span class="line">---&gt; Package vim-filesystem.x86_64 2:7.4.160-5.el7 will be installed</span><br><span class="line">--&gt; Finished Dependency Resolution</span><br><span class="line">Dependencies Resolved</span><br><span class="line"></span><br><span class="line">=================================================================================================================</span><br><span class="line"> Package                      Arch                 Version                        Repository                Size</span><br><span class="line">=================================================================================================================</span><br><span class="line">Installing:</span><br><span class="line"> vim-enhanced                 x86_64               2:7.4.160-5.el7                Local-Base               1.0 M</span><br><span class="line">Installing for dependencies:</span><br><span class="line"> gpm-libs                     x86_64               1.20.7-5.el7                   Local-Base                32 k</span><br><span class="line"> vim-common                   x86_64               2:7.4.160-5.el7                Local-Base               5.9 M</span><br><span class="line"> vim-filesystem               x86_64               2:7.4.160-5.el7                Local-Base                10 k</span><br><span class="line"></span><br><span class="line">Transaction Summary</span><br><span class="line">=================================================================================================================</span><br><span class="line">Install  1 Package (+3 Dependent packages)</span><br><span class="line"></span><br><span class="line">Total download size: 7.0 M</span><br><span class="line">Installed size: 23 M</span><br><span class="line"></span><br><span class="line">Is this ok [y/d/N]: y</span><br><span class="line">Downloading packages:</span><br><span class="line">(1/4): gpm-libs-1.20.7-5.el7.x86_64.rpm                                                   |  32 kB  00:00:00     </span><br><span class="line">(2/4): vim-enhanced-7.4.160-5.el7.x86_64.rpm                                              | 1.0 MB  00:00:00</span><br><span class="line">(3/4): vim-filesystem-7.4.160-5.el7.x86_64.rpm                                            |  10 kB  00:00:00</span><br><span class="line">(4/4): vim-common-7.4.160-5.el7.x86_64.rpm                                                | 5.9 MB  00:00:00</span><br><span class="line">-----------------------------------------------------------------------------------------------------------------</span><br><span class="line">Total                                                                             55 MB/s | 7.0 MB  00:00:00</span><br><span class="line">Running transaction check</span><br><span class="line">Running transaction test</span><br><span class="line">Transaction test succeeded</span><br><span class="line">Running transaction</span><br><span class="line">Warning: RPMDB altered outside of yum.</span><br><span class="line">** Found 1 pre-existing rpmdb problem(s), &apos;yum check&apos; output follows:</span><br><span class="line">mokutil-15-1.el7.x86_64 is a duplicate with mokutil-12-1.el7.x86_64</span><br><span class="line">  Installing : gpm-libs-1.20.7-5.el7.x86_64                                                                  1/4</span><br><span class="line">  Installing : 2:vim-filesystem-7.4.160-5.el7.x86_64                                                         2/4</span><br><span class="line">  Installing : 2:vim-common-7.4.160-5.el7.x86_64                                                             3/4</span><br><span class="line">  Installing : 2:vim-enhanced-7.4.160-5.el7.x86_64                                                           4/4</span><br><span class="line">Local-Base/productid                                                                      | 2.1 kB  00:00:00</span><br><span class="line">Local-Supplementary/productid                                                             | 2.1 kB  00:00:00</span><br><span class="line">  Verifying  : 2:vim-enhanced-7.4.160-5.el7.x86_64                                                           1/4</span><br><span class="line">  Verifying  : 2:vim-common-7.4.160-5.el7.x86_64                                                             2/4</span><br><span class="line">  Verifying  : 2:vim-filesystem-7.4.160-5.el7.x86_64                                                         3/4</span><br><span class="line">  Verifying  : gpm-libs-1.20.7-5.el7.x86_64                                                                  4/4</span><br><span class="line"></span><br><span class="line">Installed:</span><br><span class="line">  vim-enhanced.x86_64 2:7.4.160-5.el7</span><br><span class="line"></span><br><span class="line">Dependency Installed:</span><br><span class="line">  gpm-libs.x86_64 0:1.20.7-5.el7    vim-common.x86_64 2:7.4.160-5.el7    vim-filesystem.x86_64 2:7.4.160-5.el7</span><br><span class="line"></span><br><span class="line">Complete!</span><br></pre></td></tr></table></figure>
<p>Here we see yum find <code>x86_64</code> version of vim in <code>Local-Base</code> repository. Sometimes you will usually want the latest version of a package, but you can provide additional qualifications if you need an earlier version, or the <code>i686</code> version instead of the <code>x86_64</code> version. See the section on specifying package names in the man pages for the yum command.</p>
<h3 id="Package-locations">Package locations</h3>
<p>Where do the packages come from? How does yum know where to download packages from? The starting point is the <code>/etc/yum.repos.d/</code> directory, which usually contains several repo files. This is the default location for repository information, but other locations may be specified in the YUM configuration file, normally <code>/etc/yum.conf</code>.</p>
<p>In the Fyre machine, there is a <code>devit-rh7-x86_64.repo</code> file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># Base OS packages</span><br><span class="line">[Local-Base]</span><br><span class="line">name=Fyre Local OS repository</span><br><span class="line">baseurl=http://fyreyum1.fyre.ibm.com/redhat/yum/server/7/7Server/x86_64/os</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">[Local-Supplementary]</span><br><span class="line">name=Fyre Local Supplementary repository</span><br><span class="line">baseurl=http://fyreyum1.fyre.ibm.com/redhat/yum/server/7/7Server/x86_64/supplementary/os</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">[Local-Optional]</span><br><span class="line">name=Fyre Local Optional repository</span><br><span class="line">baseurl=http://fyreyum1.fyre.ibm.com/redhat/yum/server/7/7Server/x86_64/optional/os</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">[Local-Extras]</span><br><span class="line">name=Fyre Local Extras repository</span><br><span class="line">baseurl=http://fyreyum1.fyre.ibm.com/redhat/yum/server/7/7Server/x86_64/extras/os</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br></pre></td></tr></table></figure>
<p>YUM and RPM use a local database to determine what packages are installed. The metadata about packages that is stored in the local database is retrieved from the enabled repositories. Although you will seldom need to worry about the local database, you use the command <code>yum clean all</code> to clean out various parts of the locally stored information and <code>yum makecache</code> to create the information in your local database for the enabled repos. You might do this if you change your repo configuration, for example.</p>
<h3 id="Removing-RPM-packages">Removing RPM packages</h3>
<p>The RPM system does not maintain information on packages that were automatically added, so there is no trivial way to find out which dependencies might also be removed.</p>
<p>If you use YUM and if the package you are trying to remove is a <em>dependent package</em> for some other installed packages, then YUM will offer to remove those as well as the dependent package. (This is different from <code>yum autoremove</code>)</p>
<h3 id="Upgrading-RPM-packages">Upgrading RPM packages</h3>
<p>You can use <code>yum update</code> to update your entire system, or you can specify a single package or a wildcard specification. Listing 8 shows how to update all the packages whose names start with “pop”. Note the use of apostrophes to prevent shell expansion of the “*”.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum update &apos;pop*&apos;</span><br><span class="line">yum update elasticsearch-7.10.2</span><br></pre></td></tr></table></figure>
<p><a href="https://unix.stackexchange.com/questions/55777/in-centos-what-is-the-difference-between-yum-update-and-yum-upgrade" target="_blank" rel="noopener">what is the difference between yum update and yum upgrade?</a>
<code>yum upgrade</code> forces the removal of obsolete packages, while <code>yum update</code> may or may not also do this. The removal of obsolete packages can be risky, as it may remove packages that you use.
This makes <code>yum update</code> the safer option.</p>
<h3 id="Querying-RPM-packages">Querying RPM packages</h3>
<p>In our examples you saw that installing an rpm with the <code>rpm</code> command requires the full name of the package file (or URL), such as <code>gcc-gfortran-4.9.2-6.fc21.x8664.rpm</code>. On the other hand, installing with <code>yum</code>, or removing an rpm with either command requires only the package name, such as <code>gcc-gfortran</code>. As with APT, YUM maintains an internal database of your installed packages, allowing you to manipulate installed packages using the package name.</p>
<p>Note that you need to have root authority to install, upgrade, or remove packages, but non-root users can perform queries against the rpm database.</p>
<p>Basic query asks if package is installed, if so, show version number:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@mycentctl1 ~]# rpm -q bind-utils</span><br><span class="line">bind-utils-9.9.4-73.el7_6.x86_64</span><br><span class="line"></span><br><span class="line">[root@mycentctl1 ~]# rpm -q ansible</span><br><span class="line">package ansible is not installed</span><br><span class="line"></span><br><span class="line">[root@mycentctl1 ~]# yum list bind-utils</span><br><span class="line">Loaded plugins: product-id, search-disabled-repos</span><br><span class="line">Installed Packages</span><br><span class="line">bind-utils.x86_64                                    32:9.9.4-73.el7_6                                    @Local-Base</span><br><span class="line"></span><br><span class="line">[root@mycentctl1 ~]# yum list ansible</span><br><span class="line">Loaded plugins: product-id, search-disabled-repos</span><br><span class="line">Available Packages</span><br><span class="line">ansible.noarch                                       2.4.2.0-2.el7                                       Local-Extras</span><br></pre></td></tr></table></figure>
<p>Display info about a package:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@mycentctl1 ~]# yum info bind-utils</span><br><span class="line">Loaded plugins: product-id, search-disabled-repos</span><br><span class="line">Installed Packages</span><br><span class="line">Name        : bind-utils</span><br><span class="line">Arch        : x86_64</span><br><span class="line">Epoch       : 32</span><br><span class="line">Version     : 9.9.4</span><br><span class="line">Release     : 73.el7_6</span><br><span class="line">Size        : 431 k</span><br><span class="line">Repo        : installed</span><br><span class="line">From repo   : Local-Base</span><br><span class="line">Summary     : Utilities for querying DNS name servers</span><br><span class="line">URL         : http://www.isc.org/products/BIND/</span><br><span class="line">License     : ISC</span><br><span class="line">Description : Bind-utils contains a collection of utilities for querying DNS (Domain</span><br><span class="line">            : Name System) name servers to find out information about Internet</span><br><span class="line">            : hosts. These tools will provide you with the IP addresses for given</span><br><span class="line">            : host names, as well as other information about registered domains and</span><br><span class="line">            : network addresses.</span><br><span class="line">            :</span><br><span class="line">            : You should install bind-utils if you need to get information from DNS name</span><br><span class="line">            : servers.</span><br></pre></td></tr></table></figure>
<p>Search package names and descriptions for a term</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@mycentctl1 ~]# yum search vim</span><br><span class="line">Loaded plugins: product-id, search-disabled-repos</span><br><span class="line">================================================= N/S matched: vim ==================================================</span><br><span class="line">golang-vim.noarch : Vim plugins for Go</span><br><span class="line">protobuf-vim.x86_64 : Vim syntax highlighting for Google Protocol Buffers descriptions</span><br><span class="line">vim-X11.x86_64 : The VIM version of the vi editor for the X Window System</span><br><span class="line">vim-common.x86_64 : The common files needed by any version of the VIM editor</span><br><span class="line">vim-enhanced.x86_64 : A version of the VIM editor which includes recent enhancements</span><br><span class="line">vim-filesystem.x86_64 : VIM filesystem layout</span><br><span class="line">vim-minimal.x86_64 : A minimal version of the VIM editor</span><br><span class="line"></span><br><span class="line">  Name and summary matches only, use &quot;search all&quot; for everything.</span><br></pre></td></tr></table></figure>
<h3 id="RPM-packages-and-files-in-them">RPM packages and files in them</h3>
<p>List the files inside the package, you will see <code>host</code> command is here:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@mycentctl1 ~]# rpm -ql bind-utils</span><br><span class="line">/etc/trusted-key.key</span><br><span class="line">/usr/bin/dig</span><br><span class="line">/usr/bin/host</span><br><span class="line">/usr/bin/nslookup</span><br><span class="line">/usr/bin/nsupdate</span><br><span class="line">/usr/share/man/man1/dig.1.gz</span><br><span class="line">/usr/share/man/man1/host.1.gz</span><br><span class="line">/usr/share/man/man1/nslookup.1.gz</span><br><span class="line">/usr/share/man/man1/nsupdate.1.gz</span><br></pre></td></tr></table></figure>
<p>if you have a download package and want to know the files in it, <code>-p</code> means package:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@mycentctl1 ~]# rpm -qlp jq-1.5-1.el7.x86_64.rpm</span><br><span class="line">warning: jq-1.5-1.el7.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 352c64e5: NOKEY</span><br><span class="line">/usr/bin/jq</span><br><span class="line">/usr/lib64/libjq.so.1</span><br><span class="line">/usr/lib64/libjq.so.1.0.4</span><br><span class="line">/usr/share/doc/jq/AUTHORS</span><br><span class="line">/usr/share/doc/jq/COPYING</span><br><span class="line">/usr/share/doc/jq/README</span><br><span class="line">/usr/share/doc/jq/README.md</span><br><span class="line">/usr/share/man/man1/jq.1.gz</span><br></pre></td></tr></table></figure>
<h3 id="Which-package-owns-a-file">Which package owns a file?</h3>
<p>For YUM:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum provides vim</span><br></pre></td></tr></table></figure>
<p>For RPM:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qf `which vim`</span><br></pre></td></tr></table></figure>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/linux/" rel="tag"># linux</a>
          
            <a href="/tags/yum/" rel="tag"># yum</a>
          
            <a href="/tags/rpm/" rel="tag"># rpm</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/03/26/k8s-external-access/" rel="next" title="Kubernetes NodePort vs LoadBalancer vs Ingress">
                <i class="fa fa-chevron-left"></i> Kubernetes NodePort vs LoadBalancer vs Ingress
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/03/27/linux-distros/" rel="prev" title="Check Linux Distributions">
                Check Linux Distributions <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/cuishao.png" alt="海胆阶段">
            
              <p class="site-author-name" itemprop="name">海胆阶段</p>
              <p class="site-description motion-element" itemprop="description">骐骥一跃，不能十步；驽马十驾，功在不舍</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">288</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">47</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">158</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Introducing-package-management"><span class="nav-number">1.</span> <span class="nav-text">Introducing package management</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Package-managers"><span class="nav-number">2.</span> <span class="nav-text">Package managers</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#RPM"><span class="nav-number">2.1.</span> <span class="nav-text">RPM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#YUM"><span class="nav-number">2.2.</span> <span class="nav-text">YUM</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Install-RPM-packages"><span class="nav-number">3.</span> <span class="nav-text">Install RPM packages</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Package-locations"><span class="nav-number">4.</span> <span class="nav-text">Package locations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Removing-RPM-packages"><span class="nav-number">5.</span> <span class="nav-text">Removing RPM packages</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Upgrading-RPM-packages"><span class="nav-number">6.</span> <span class="nav-text">Upgrading RPM packages</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Querying-RPM-packages"><span class="nav-number">7.</span> <span class="nav-text">Querying RPM packages</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RPM-packages-and-files-in-them"><span class="nav-number">8.</span> <span class="nav-text">RPM packages and files in them</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Which-package-owns-a-file"><span class="nav-number">9.</span> <span class="nav-text">Which package owns a file?</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2023</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chengdong Liao</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v6.7.0</div>





  <script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize("");
    }
  </script>

        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=6.7.0"></script>

  <script src="/js/src/motion.js?v=6.7.0"></script>



  
  

  
  <script src="/js/src/scrollspy.js?v=6.7.0"></script>
<script src="/js/src/post-details.js?v=6.7.0"></script>



  


  <script src="/js/src/bootstrap.js?v=6.7.0"></script>



  



  











  

  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  

  

  

  

  

  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap');
      $(e).after($wrap);
      $wrap.append($('<button>').addClass('copy-btn').append('Copy').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text();
        }).toArray().join('\n');
        var ta = document.createElement('textarea');
        var range = document.createRange(); //For Chrome
        var sel = window.getSelection(); //For Chrome
        var yPosition = window.pageYOffset || document.documentElement.scrollTop;
        ta.style.top = yPosition + 'px'; //Prevent page scroll
        ta.style.position = 'absolute';
        ta.style.opacity = '0';
        ta.value = code;
        ta.textContent = code; //For FireFox
        ta.contentEditable = true;
        ta.readOnly = false;
        document.body.appendChild(ta);
        range.selectNode(ta);
        sel.removeAllRanges();
        sel.addRange(range);
        ta.setSelectionRange(0, code.length);
        var result = document.execCommand('copy');
        
          if (result) $(this).text('Copied');
          else $(this).text('Copy failed');
        
        ta.blur(); //For iOS
        $(this).blur();
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn');
        setTimeout(function () {
          $b.text('Copy');
        }, 300);
      }).append(e);
    })
  </script>


  

</body>
</html>
